<!-- FIXME Remove check for whether isFulfilled exists -->
<!-- FIXME Remove check for getAnnotation -->
<!-- TODO This seems slightly janky -->
<ng-template #annotation>
  <div [outerHTML]="getAnnotation()"></div>
</ng-template>
<ng-template #multiReq>
  <!-- TODO Make this look better -->
  <!-- TODO Find a better way to cast variables in HTML templates -->
  <td
    class="nested"
    [ngClass]="getMulti().isFulfilled && getMulti().isFulfilled(courses) ? 'fulfilled' : 'unfulfilled'"
    [ngbPopover]="getMulti().getAnnotation && getMulti().getAnnotation() ? annotation : null"
    triggers="mouseenter:mouseleave"
  >
    {{ getMulti().numRequired }} of:
    <table>
      <tbody
        app-requirement
        *ngFor="let childReq of getMulti().requirements"
        [requirement]="childReq"
        [courses]="courses"
      ></tbody>
    </table>
  </td>
</ng-template>
<tr>
  <ng-container *ngIf="!isMulti(); else multiReq">
    <td
      [ngClass]="requirement.isFulfilled && requirement.isFulfilled(courses) ? 'fulfilled' : 'unfulfilled'"
      [ngbPopover]="requirement.getAnnotation && requirement.getAnnotation() ? annotation : null"
      triggers="mouseenter:mouseleave"
    >
      {{ requirement.name }}<span *ngIf="getAnnotation()"> *</span>
    </td>
  </ng-container>
</tr>
